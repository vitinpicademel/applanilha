(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{3677:function(e,r,t){Promise.resolve().then(t.bind(t,4218))},4808:function(e,r,t){"use strict";t.d(r,{H:function(){return d},a:function(){return u}});var s=t(7437),o=t(2265),a=t(1872),l=t(5925),i=t(1490);let n=(0,o.createContext)(void 0);function d(e){let{children:r}=e,[t,d]=(0,o.useState)({user:null,isAuthenticated:!1});(0,o.useEffect)(()=>{let e=localStorage.getItem("auth"),r=i.Z.get("auth");if(e&&r&&d(JSON.parse(e)),0===JSON.parse(localStorage.getItem("users")||"[]").length){let e={id:(0,a.Z)(),email:"admin@admin.com",name:"Administrador",role:"MASTER",password:"admin123",createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()};localStorage.setItem("users",JSON.stringify([e]))}},[]),(0,o.useEffect)(()=>{t.isAuthenticated?(localStorage.setItem("auth",JSON.stringify(t)),i.Z.set("auth","true",{expires:7})):(localStorage.removeItem("auth"),i.Z.remove("auth"))},[t]);let u=async(e,r)=>{let t=JSON.parse(localStorage.getItem("users")||"[]"),s=t.find(t=>t.email===e&&t.password===r);if(s){let e=t.map(e=>e.id===s.id?{...e,lastLogin:new Date().toISOString()}:e);localStorage.setItem("users",JSON.stringify(e));let r={user:{...s,lastLogin:new Date().toISOString()},isAuthenticated:!0};return d(r),localStorage.setItem("auth",JSON.stringify(r)),i.Z.set("auth","true",{expires:7}),l.toast.success("Login realizado com sucesso!"),!0}return l.toast.error("Email ou senha inv\xe1lidos"),!1},c=async e=>{let r=JSON.parse(localStorage.getItem("users")||"[]");if(r.some(r=>r.email===e.email))return l.toast.error("Email j\xe1 cadastrado"),!1;if("GESTOR"===e.role&&!e.teamId)return l.toast.error("ID da equipe \xe9 obrigat\xf3rio para Gestores"),!1;if("CORRETOR"===e.role&&!e.managerId)return l.toast.error("ID do gestor \xe9 obrigat\xf3rio para Corretores"),!1;if("CORRETOR"===e.role&&!r.some(r=>"GESTOR"===r.role&&r.id===e.managerId))return l.toast.error("Gestor n\xe3o encontrado"),!1;let t={id:(0,a.Z)(),...e,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()};return r.push(t),localStorage.setItem("users",JSON.stringify(r)),l.toast.success("Usu\xe1rio registrado com sucesso!"),!0};return(0,s.jsx)(n.Provider,{value:{...t,login:u,logout:()=>{d({user:null,isAuthenticated:!1}),localStorage.removeItem("auth"),i.Z.remove("auth"),l.toast.success("Logout realizado com sucesso!")},register:c,getUsers:()=>{let e=JSON.parse(localStorage.getItem("users")||"[]");if(!t.user)return[];switch(t.user.role){case"MASTER":return e;case"GESTOR":return e.filter(e=>{var r;return"CORRETOR"===e.role&&e.managerId===(null===(r=t.user)||void 0===r?void 0:r.id)});default:return[]}},deleteUser:e=>{var r;if((null===(r=t.user)||void 0===r?void 0:r.role)!=="MASTER"){l.toast.error("Sem permiss\xe3o para excluir usu\xe1rios");return}let s=JSON.parse(localStorage.getItem("users")||"[]").filter(r=>r.id!==e);localStorage.setItem("users",JSON.stringify(s)),l.toast.success("Usu\xe1rio exclu\xeddo com sucesso!")},updateUser:(e,r)=>{var s,o,a;if((null===(s=t.user)||void 0===s?void 0:s.id)!==e&&(null===(o=t.user)||void 0===o?void 0:o.role)!=="MASTER"){l.toast.error("Sem permiss\xe3o para atualizar usu\xe1rios");return}let i=JSON.parse(localStorage.getItem("users")||"[]").map(t=>t.id===e?{...t,...r}:t);if(localStorage.setItem("users",JSON.stringify(i)),e===(null===(a=t.user)||void 0===a?void 0:a.id)){let r=i.find(r=>r.id===e);r&&d(e=>({...e,user:r}))}l.toast.success("Informa\xe7\xf5es atualizadas com sucesso!")}},children:r})}let u=()=>{let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4218:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return u}});var s=t(7437),o=t(2265),a=t(4808),l=t(4033),i=t(5925),n=t(6691),d=t.n(n);function u(){let[e,r]=(0,o.useState)({name:"",email:"",password:"",confirmPassword:"",role:"CORRETOR",teamId:"",managerId:""}),[t,n]=(0,o.useState)(!1),{register:u}=(0,a.a)(),c=(0,l.useRouter)(),m=e=>{let{name:t,value:s}=e.target;r(e=>({...e,[t]:s}))},g=async r=>{if(r.preventDefault(),n(!0),e.password!==e.confirmPassword){i.toast.error("As senhas n\xe3o coincidem"),n(!1);return}try{await u({name:e.name,email:e.email,password:e.password,role:e.role,teamId:"GESTOR"===e.role?e.teamId:void 0,managerId:"CORRETOR"===e.role?e.managerId:void 0})&&(i.toast.success("Conta criada com sucesso!"),c.push("/login"))}finally{n(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#2A2A2A] py-8",children:(0,s.jsxs)("div",{className:"bg-[#373737] p-8 rounded-lg shadow-lg w-full max-w-md",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center mb-8",children:[(0,s.jsx)("div",{className:"w-24 h-24 relative mb-4 rounded-full overflow-hidden border-2 border-[#938667]",children:(0,s.jsx)(d(),{src:"/images/logo.png",alt:"Logo da empresa",fill:!0,className:"object-contain",priority:!0})}),(0,s.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Criar conta"}),(0,s.jsx)("p",{className:"text-[#938667] mt-2",children:"Preencha os dados para se registrar"})]}),(0,s.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-[#938667] mb-2",children:"Nome completo"}),(0,s.jsx)("input",{id:"name",name:"name",type:"text",required:!0,value:e.name,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-[#938667] mb-2",children:"E-mail"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",required:!0,value:e.email,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-[#938667] mb-2",children:"Senha"}),(0,s.jsx)("input",{id:"password",name:"password",type:"password",required:!0,value:e.password,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-[#938667] mb-2",children:"Confirme a senha"}),(0,s.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:e.confirmPassword,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-[#938667] mb-2",children:"Tipo de usu\xe1rio"}),(0,s.jsxs)("select",{id:"role",name:"role",required:!0,value:e.role,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]",children:[(0,s.jsx)("option",{value:"CORRETOR",children:"Corretor"}),(0,s.jsx)("option",{value:"GESTOR",children:"Gestor"})]})]}),"GESTOR"===e.role&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"teamId",className:"block text-sm font-medium text-[#938667] mb-2",children:"ID da Equipe"}),(0,s.jsx)("input",{id:"teamId",name:"teamId",type:"text",required:!0,value:e.teamId,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]"})]}),"CORRETOR"===e.role&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"managerId",className:"block text-sm font-medium text-[#938667] mb-2",children:"ID do Gestor"}),(0,s.jsx)("input",{id:"managerId",name:"managerId",type:"text",required:!0,value:e.managerId,onChange:m,className:"w-full px-4 py-2 bg-[#2A2A2A] border border-[#938667] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#938667]"})]}),(0,s.jsx)("button",{type:"submit",disabled:t,className:"w-full py-3 px-4 bg-[#938667] text-white rounded-lg font-medium mt-6\n              ".concat(t?"opacity-50 cursor-not-allowed":"hover:bg-[#7a6f55] transition-colors","\n            "),children:t?"Registrando...":"Registrar"})]}),(0,s.jsxs)("div",{className:"mt-6 text-center",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("div",{className:"w-full border-t border-[#938667]/30"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,s.jsx)("span",{className:"px-2 bg-[#373737] text-[#938667]",children:"J\xe1 tem uma conta?"})})]}),(0,s.jsx)("button",{onClick:()=>{c.push("/login")},className:"mt-4 w-full py-3 px-4 bg-transparent text-[#938667] border border-[#938667] rounded-lg font-medium  hover:bg-[#938667] hover:text-white transition-colors",children:"Fazer login"})]})]})})}}},function(e){e.O(0,[883,971,938,744],function(){return e(e.s=3677)}),_N_E=e.O()}]);